# DistributedSemaphore

## Общее назначение

`DistributedSemaphore` — это класс для управления распределённым семафором с использованием Redis. Семафор позволяет
контролировать доступ к ограниченному числу ресурсов, предоставляя фиксированное количество "слотов", которые могут быть
захвачены одновременно. Это полезно для регулирования доступа к ресурсам, которые не могут быть использованы параллельно
бесконечным количеством процессов.

## Использование Redis

Для контроля доступа используется Redis. Семафор реализован через ключ `key`, значение которого указывает на количество
доступных слотов. LUA-скрипты используются для атомарной модификации этого значения, что обеспечивает надёжность
операций захвата и освобождения слотов.

## Методы класса

### `__init__(self, redis: 'Redis[Any]', key: str, value: int, acquire_sleep_delay: float = 0.1, acquire_timeout: float | None = None)`

Инициализирует экземпляр распределённого семафора.

- `redis`: клиент Redis, который будет использоваться для семафора.
- `key`: ключ в Redis, используемый для хранения состояния семафора.
- `value`: максимальное количество слотов семафора.
- `acquire_sleep_delay`: задержка между попытками захвата слота семафора в секундах.
- `acquire_timeout`: максимальное время попыток захвата слота в секундах.

### `async acquire(self, acquire_sleep_delay: float | None = None, acquire_timeout: float | None = None) -> bool`

Асинхронно пытается захватить слот семафора.

- `acquire_sleep_delay`: переопределяет стандартную задержку между попытками захвата.
- `acquire_timeout`: переопределяет стандартное время ожидания захвата слота.

### `async release(self) -> None`

Асинхронно освобождает слот семафора.

### `async locked(self) -> bool`

Проверяет, заблокирован ли семафор (отсутствуют доступные слоты).

## Примеры использования

1. **Регулирование доступа к пулу соединений.** Используйте семафор для контроля доступа к ограниченному числу
   одновременных соединений с базой данных.
2. **Ограничение параллельной обработки.** Контролируйте количество параллельно выполняемых задач, чтобы избежать
   перегрузки системы.
3. **Синхронизация доступа к ресурсам в микросервисной архитектуре.** Несколько микросервисов могут использовать семафор
   для синхронизации доступа к общим ресурсам, таким как логические единицы обработки данных.
